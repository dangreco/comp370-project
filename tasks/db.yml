---
# yaml-language-server: $schema=https://taskfile.dev/schema.json
# yamllint disable rule:line-length
version: "3"

tasks:
  clean:
    desc: Cleanup database files
    summary: |
      Remove all generated database files in the data/ directory.
      Use this task to reset the database state before seeding it again.
    silent: true
    prompt:
      - Are you sure you want to delete all database files in the data/ directory?
    cmds:
      - rm -rf data/**/*

  seed:
    desc: Seed database with initial data
    summary: |
      Generate and seed the database by scraping the required data sources.
      This task depends on the clean task to ensure a fresh state before seeding.
      This task is long-running -- expect several minutes to complete.
    silent: true
    generates:
      - data/comp370.db
    status:
      - test -f data/comp370.db
    cmds:
      - task db:clean --yes
      - uv run python scripts/python/db/seed.py
